#:kivy 2.1.0

<RootLayout>:
    orientation: 'vertical'
    
    ChatLayout:
        id: chat_layout

<ChatLayout>:
    orientation: 'horizontal'
    spacing: 10
    padding: 10

    BoxLayout:
        id: emoji_panel
        orientation: 'vertical'
        size_hint_x: None # Let the animation control the width
        width: 0 # Start with zero width
        opacity: 0
        disabled: True

    BoxLayout:
        id: chat_panel
        orientation: 'vertical'
        # No size_hint_x needed, it will fill the remaining space

        ScrollView:
            id: chat_scroll
            scroll_type: ['bars', 'content']
            bar_width: 10
            BoxLayout:
                id: chat_box
                orientation: 'vertical'
                size_hint_y: None
                height: self.minimum_height
                spacing: 5
                # The font_name for labels is set dynamically in client.py

        BoxLayout:
            id: input_layout
            size_hint_y: None
            height: 40
            spacing: 5
            TextInput:
                id: msg_entry
                multiline: False
                hint_text: app.tr.get('message_input_hint', "Type a message...")
                font_name: 'EmojiFont'
            Button:
                id: record_button
                text: 'üé§'
                font_name: 'EmojiFont'
                size_hint_x: None
                width: 40
            Button:
                id: emoji_button
                text: 'üôÇ'
                font_name: 'EmojiFont'
                size_hint_x: None
                width: 40
            Button:
                id: send_button
                text: app.tr.get('send_button', 'Send')
                size_hint_x: None
                width: 80

    BoxLayout:
        id: users_panel
        orientation: 'vertical'
        size_hint_x: None # Let's fix the width for the right panel
        width: 250 # A fixed width for the user panel
        spacing: 5

        BoxLayout:
            id: users_panel_controls
            orientation: 'vertical'
            size_hint_y: None
            height: self.minimum_height
            spacing: 5
            padding: (0, 5)

            BoxLayout:
                id: group_actions_layout
                size_hint_y: None
                height: 40
                spacing: 5
            
            Label:
                id: users_list_label
                text: app.tr.get('users_in_chat_label', 'Users Online')
                size_hint_y: None
                height: 30
        
        ScrollView:
            id: users_scroll
            scroll_type: ['bars', 'content']
            bar_width: 10
            BoxLayout:
                id: users_list
                orientation: 'vertical'
                size_hint_y: None
                height: self.minimum_height
        
        BoxLayout:
            size_hint_y: None
            height: 44
            spacing: 5
            Button:
                id: settings_button
                text: '‚öôÔ∏è'
                font_name: 'EmojiFont'
                size_hint_x: None
                width: 44
            Button:
                id: theme_button
                text: app.tr.get('toggle_theme_button', 'Toggle Theme')